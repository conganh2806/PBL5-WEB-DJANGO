{% if message %}
<script>
    alert('{{ message }}');
</script>
{% endif %}
<!DOCTYPE html>
<html lang="en">

<head>
    {% load static %}
    <meta charset="utf-8">
    <title>Setting</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{% static "./css/setting.css"%}">
    {% comment %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css" rel="stylesheet">
    {% endcomment %}
</head>

<body>
    
    <div class="container">
        <div class="row gutters">
            <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="account-settings">
                            <div class="user-profile">
                                <div class="user-avatar">
                                    <img src="{% static './img/personicon.png' %}" alt="Maxwell Admin">
                                    {% comment %} <img src="https://bootdey.com/img/Content/avatar/avatar7.png"
                                        alt="Maxwell Admin"> {% endcomment %}
                                </div>
                                <h5 id="username" class="user-name">{{username}}</h5>
                                <h6 class="user-email">
                                    <a style="color: #34AF6D !important;" href="/cdn-cgi/l/email-protection"
                                        class="__cf_email__"
                                        data-cfemail="f48d819f9db4b9958c83919898da979b99">{{email}}
                                    </a>
                                </h6>
                            </div>
                            <div class="about">
                                <h5 class="title">About</h5>
                                <p>I'm {{username}}. I'm a teacher.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
                <div class="col-xl-9 col-lg-9 col-md-12 col-sm-12 col-12">
                    <div class="card h-100">
                        <form action="/postUpdate/" method="post">
                            {% csrf_token %}
                            <div class="card-body">
                                <div class="row gutters">
                                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                                        <h6 class="mb-2 text-primary" style="color: #34AF6D !important;">Personal Details
                                        </h6>
                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                                        <div class="form-group">
                                            <label for="fullName">Full name</label>
                                            <input type="text" class="form-control" name ="fullName" id="fullName"
                                                placeholder="Enter full name" >
                                        </div>
                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                                        <div class="form-group">
                                            <label for="eMail">Email</label>
                                            <input type="email" class="form-control" name="eMail" id="eMail"
                                                placeholder="Enter email ID" value="{{email}}" readonly>
                                        </div>
                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                                        <div class="form-group">
                                            <label for="phone">Phone</label>
                                            <input type="text" class="form-control" id="phone" name="phone"
                                                placeholder="Enter phone number" >
                                        </div>
                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                                        <div class="form-group">
                                            <label for="website">Address</label>
                                            <input type="text" class="form-control" id="Adress" name="Adress" placeholder="Enter Adress" >
                                        </div>
                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                                        <div class="form-group">
                                            <label for="website">Student ID</label>
                                            <input type="text" class="form-control" id="School" name="School" placeholder="Enter School" >
                                        </div>
                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                                        <div style="margin-top:30px">
                                            <!-- <input type="url" class="form-control" id="website" placeholder="Image"> -->
                                            <input type="file" class="form-control" type="file" id="imageUpload" multiple> 
                                            <input type="hidden" name="url" id="url" />
                                            <button type="button" onclick ="uploadimage()" style=" margin-top: 30px;" title='Upload image before update your profile'>Upload Image</button> 
                                            
                                        </div>
                                    </div>
                                </div>
                                <div class="row gutters">
                                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                                        <div class="text-right">
                                            <button type="submit" name="Cancel" id="Cancel" name="Cancel" 
                                                class="btn btn-secondary" onclick= "location.href='{% url 'homepage' %}' ">Cancel</button>
                                            <button type="submit" id="Update" name="Update" class="btn btn-primary"
                                                style="background-color: #34AF6D;border: #34AF6D;">Update</button>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </form>

                        </div>
                    </div>
                </div>
            
        </div>
    </div>
    {% comment %} <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js">
    </script>
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.bundle.min.js"></script>
    {% endcomment %}
    {% load static %}
    <script src="{% static 'js/email-decode.min.js' %}" data-cfasync="false"></script>
    <script src="{% static 'js/jquery-1.10.2.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script>
        // adding firebase data
        var firebaseConfig = {
            apiKey: "AIzaSyAq7-ziABaQCTxfeOlMIbv8jvfQk2B7lmQ",
            authDomain: "pbl5-94125.firebaseapp.com",
            databaseURL: "https://pbl5-94125-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "pbl5-94125",
            storageBucket: "pbl5-94125.appspot.com",
            messagingSenderId: "42461525472",
            appId: "1:42461525472:web:e0519d8a1a0e0644f1e785",
            measurementId: "G-K47401613X"
        };
        
        firebase.initializeApp(firebaseConfig);
        var storageRef = firebase.storage().ref();
        //uploading file in storage
        function uploadimage() {
            var files = document.getElementById("imageUpload").files;
            var userName = document.getElementById("username").textContent;
            console.log(userName);
            for (var i = 0; i < files.length; i++) {
                var file = files[i];
                var storageChildRef = storageRef.child('Image').child(userName).child('face_recognition').child(file.name);
                var task = storageChildRef.put(file);
                task.on("state_changed", function(snapshot) {
                    // Xử lý quá trình upload
                }, function(error) {
                    // Xử lý lỗi
                }, function() {
                    // Xử lý khi upload thành công
                    console.log("upload image done");
                });
            }
           
        }
       
        // Save message to firebase database
        function saveMessage(url) {
            var newMessageRef = messagesRef.push();
            newMessageRef.set({
                imageurl: url,
            });
        }
        
    </script>
</html>

</body>

</html>